"use strict";define(["emitter","vector","field","utils","audio"],function(t,i,e,n,s){var a={canvas:void 0,ctx:void 0,centerX:void 0,centerY:void 0,emitters:[],drawQueue:[],updateQueue:[],fields:[],maxFields:3,audioData:void 0,initEmitters:function(){var e=new t(this.canvas,this.ctx,this.fields,new i(this.centerX,this.centerY),i.fromAngle(0,2),Math.PI);this.emitters.push(e),this.drawQueue.push(e.draw.bind(e)),this.updateQueue.push(e.update.bind(e))},initFields:function(){var t=new e(this.ctx,new i(this.centerX+this.centerX/2,this.centerY),600);this.fields.push(t),this.drawQueue.push(t.draw.bind(t)),t=new e(this.ctx,new i(this.centerX-this.centerX/2,this.centerY),600),this.fields.push(t),this.drawQueue.push(t.draw.bind(t))},initAudio:function(){s.init(document.querySelector("audio")),this.updateQueue.push(s.update.bind(s)),this.audioData=s.getAudioData(),console.log(this.audioData)},initEvents:function(){var s=this,a=0;this.canvas.addEventListener("click",function(){s.fields.length>=s.maxFields&&(s.fields.pop(),s.drawQueue.pop()),a++;var t;t=a%2===0?-100:100;var u=n.getMouse(this),h=new e(s.ctx,new i(u.x,u.y),t);s.fields.push(h),s.drawQueue.push(h.draw.bind(h))}),this.canvas.addEventListener("contextmenu",function(e){e.preventDefault(),console.log("right click"),a++;var u=n.getMouse(this),e=new t(s.canvas,s.ctx,s.fields,new i(u.x,u.y),i.fromAngle(0,2),Math.PI);return s.emitters.push(e),s.drawQueue.push(e.draw.bind(e)),s.updateQueue.push(e.update.bind(e)),!1})},update:function(){this.updateQueue.forEach(function(t){t()}),console.log(this.audioData)},draw:function(){this.drawQueue.forEach(function(t){t()})},animate:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.update(),this.draw(),window.requestAnimationFrame(this.animate.bind(this))},init:function(){this.canvas=document.querySelector("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.centerX=this.canvas.width/2,this.centerY=this.canvas.height/2,this.ctx=this.canvas.getContext("2d"),this.initAudio(),this.initEvents(),this.initEmitters(),this.initFields(),this.animate()}};return a});